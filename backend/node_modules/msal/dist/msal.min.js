/*! msal v1.4.18 2023-05-01 */
"use strict";!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():e.Msal=t()}(self,(function(){return function(){var e={795:function(e,t){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
Object.defineProperty(t,"__esModule",{value:!0}),t.__classPrivateFieldSet=t.__classPrivateFieldGet=t.__importDefault=t.__importStar=t.__makeTemplateObject=t.__asyncValues=t.__asyncDelegator=t.__asyncGenerator=t.__await=t.__spreadArrays=t.__spread=t.__read=t.__values=t.__exportStar=t.__createBinding=t.__generator=t.__awaiter=t.__metadata=t.__param=t.__decorate=t.__rest=t.__assign=t.__extends=void 0;var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r(e,t)};function n(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function i(e){return this instanceof i?(this.v=e,this):new i(e)}t.__extends=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},t.__assign=function(){return t.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.__assign.apply(this,arguments)},t.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},t.__decorate=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},t.__param=function(e,t){return function(r,n){t(r,n,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},t.__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},t.__createBinding=function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},t.__exportStar=function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])},t.__values=n,t.__read=o,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},t.__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},t.__await=i,t.__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=o[e](t)).value instanceof i?Promise.resolve(r.value.v).then(u,l):h(a[0][2],r)}catch(e){h(a[0][3],e)}var r}function u(e){c("next",e)}function l(e){c("throw",e)}function h(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}},t.__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:i(e[n](t)),done:"return"===n}:o?o(t):t}:o}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=n(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}},t.__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}},t.__classPrivateFieldGet=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},t.__classPrivateFieldSet=function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},630:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Account=void 0;var n=r(453),o=r(454),i=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var i,a=t.objectId||t.subject,s=r?r.uid:"",c=r?r.utid:"";return o.StringUtils.isEmpty(s)||(i=o.StringUtils.isEmpty(c)?n.CryptoUtils.base64Encode(s):n.CryptoUtils.base64Encode(s)+"."+n.CryptoUtils.base64Encode(c)),new e(a,i,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}();t.Account=i},681:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.buildResponseStateOnly=void 0,t.buildResponseStateOnly=function(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}},733:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.validateClaimsRequest=void 0;var n=r(550);t.validateClaimsRequest=function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw n.ClientConfigurationError.createClaimsRequestParsingError(e)}}},271:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ClientInfo=void 0;var n=r(453),o=r(356),i=r(454),a=function(){function e(t,r){if(!t||i.StringUtils.isEmpty(t))return this.uid="",void(this.utid="");try{var a=n.CryptoUtils.base64Decode(t),s=JSON.parse(a);s&&(s.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(s.uid,r):s.uid),s.hasOwnProperty("utid")&&(this.utid=s.utid))}catch(e){throw o.ClientAuthError.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var o={uid:t.subject,utid:""};return new e(n.CryptoUtils.base64Encode(JSON.stringify(o)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),o="";return i.StringUtils.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return n.CryptoUtils.base64Encode(e)},e}();t.ClientInfo=a},875:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.buildConfiguration=void 0;var n=r(795),o=r(89),i=r(741),a={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return i.UrlUtils.getCurrentUrl()},postLogoutRedirectUri:function(){return i.UrlUtils.getCurrentUrl()},navigateToLoginRequestUrl:!0},s={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},c={logger:new o.Logger(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};t.buildConfiguration=function(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,l=void 0===i?{}:i,h=e.framework,d=void 0===h?{}:h;return{auth:n.__assign(n.__assign({},a),t),cache:n.__assign(n.__assign({},s),o),system:n.__assign(n.__assign({},c),l),framework:n.__assign(n.__assign({},u),d)}}},881:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IdToken=void 0;var n=r(356),o=r(94),i=r(454),a=function(e){if(i.StringUtils.isEmpty(e))throw n.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=o.TokenUtils.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw n.ClientAuthError.createIdTokenParsingError(e)}};t.IdToken=a},89:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.LogLevel=void 0;var n,o=r(454),i=r(700);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(n=t.LogLevel||(t.LogLevel={}));var a=function(){function e(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,a=void 0===i?n.Info:i,s=t.piiLoggingEnabled,c=void 0!==s&&s;this.localCallback=e,this.correlationId=o,this.level=a,this.piiLoggingEnabled=c}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var a,s=(new Date).toUTCString();a=o.StringUtils.isEmpty(this.correlationId)?s+":"+i.version+"-"+n[e]+(r?"-pii":"")+" "+t:s+":"+this.correlationId+"-"+i.version+"-"+n[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,a,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(n.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(n.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}();t.Logger=a},55:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ScopeSet=void 0;var n=r(795),o=r(550),i=r(91),a=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(n.__spreadArrays(e)),o=this.trimAndConvertArrayToLowerCase(n.__spreadArrays(t)),i=0;i<o.length;i++)if(r.indexOf(o[i].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(n.__spreadArrays(e));return this.trimAndConvertArrayToLowerCase(n.__spreadArrays(t)).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.trimScopes=function(e){return e.map((function(e){return e.trim()}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw o.ClientConfigurationError.createScopesNonArrayError(e);if(e.length<1&&t)throw o.ClientConfigurationError.createEmptyScopesArrayError(e.toString())}else if(t)throw o.ClientConfigurationError.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(i.Constants.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(n.__spreadArrays(t)):null,o=this.trimAndConvertArrayToLowerCase(n.__spreadArrays(e));return r?n.__spreadArrays(o,r):o}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(i.Constants.openidScope)>-1&&(r+=1),e.indexOf(i.Constants.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(i.Constants.openidScope)>-1,r=e.indexOf(i.Constants.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(i.Constants.openidScope)&&t.push(i.Constants.openidScope),-1===t.indexOf(i.Constants.profileScope)&&t.push(i.Constants.profileScope),t},e.removeDefaultScopes=function(e){return e.filter((function(e){return e!==i.Constants.openidScope&&e!==i.Constants.profileScope}))},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?i.Constants.oidcScopes:e},e}();t.ScopeSet=a},436:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ServerRequestParameters=void 0;var n=r(795),o=r(453),i=r(91),a=r(55),s=r(700),c=function(){function e(e,t,r,c,u,l,h){this.authorityInstance=e,this.clientId=t,this.nonce=o.CryptoUtils.createNewGuid(),this.scopes=u?n.__spreadArrays(u):i.Constants.oidcScopes,this.scopes=a.ScopeSet.trimScopes(this.scopes),this.state=l,this.correlationId=h,this.xClientSku="MSAL.JS",this.xClientVer=s.version,this.responseType=r,this.redirectUri=c}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o;if(e)if(e.account){var a=e.account;(null===(r=a.idTokenClaims)||void 0===r?void 0:r.login_hint)?(n=i.SSOTypes.LOGIN_HINT,o=a.idTokenClaims.login_hint):a.sid?(n=i.SSOTypes.SID,o=a.sid):a.userName&&(n=i.SSOTypes.LOGIN_HINT,o=a.userName)}else e.sid?(n=i.SSOTypes.SID,o=e.sid):e.loginHint&&(n=i.SSOTypes.LOGIN_HINT,o=e.loginHint);else t&&t.hasOwnProperty(i.Constants.upn)&&(n=i.SSOTypes.ID_TOKEN,o=t.upn);return this.addSSOParameter(n,o)},e.prototype.addHintParameters=function(e,t){var r,n,o=t;return e&&(o[i.SSOTypes.SID]||o[i.SSOTypes.LOGIN_HINT]||((null===(r=e.idTokenClaims)||void 0===r?void 0:r.login_hint)?o=this.addSSOParameter(i.SSOTypes.LOGIN_HINT,null===(n=e.idTokenClaims)||void 0===n?void 0:n.login_hint,o):e.sid&&this.promptValue===i.PromptState.NONE?o=this.addSSOParameter(i.SSOTypes.SID,e.sid,o):e.userName&&(o=this.addSSOParameter(i.SSOTypes.LOGIN_HINT,e.userName,o)))),o},e.prototype.addSSOParameter=function(e,t,r){var n=r||{};if(!t)return n;switch(e){case i.SSOTypes.SID:n[i.SSOTypes.SID]=t;break;case i.SSOTypes.ID_TOKEN:case i.SSOTypes.LOGIN_HINT:n[i.SSOTypes.LOGIN_HINT]=t}return n},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===i.Constants.domain_hint&&(t||e[i.SSOTypes.SID])||(r?r+="&"+n+"="+encodeURIComponent(e[n]):r=n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return a.ScopeSet.onlyContainsOidcScopes(t)?i.ResponseTypes.id_token:e?this.responseTypeForMatchingAccounts(t):i.ResponseTypes.id_token_token},e.responseTypeForMatchingAccounts=function(e){return a.ScopeSet.containsAnyOidcScopes(e)?i.ResponseTypes.id_token_token:i.ResponseTypes.token},e}();t.ServerRequestParameters=c},463:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserAgentApplication=void 0;var n=r(795),o=r(29),i=r(192),a=r(436),s=r(660),c=r(271),u=r(881),l=r(226),h=r(630),d=r(55),p=r(454),g=r(758),f=r(94),y=r(78),m=r(741),v=r(52),E=r(756),C=r(951),T=r(875),S=r(550),_=r(986),I=r(356),b=r(447),A=r(961),w=r(681),P=n.__importDefault(r(478)),R=r(663),k=r(91),O=r(453),N=r(405),U=r(49),M=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=T.buildConfiguration(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),N.TrustedAuthority.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),C.AuthorityFactory.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new l.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var t=window.location.hash,r=m.UrlUtils.urlContainsHash(t);(g.WindowUtils.checkIfBackButtonIsPressed(this.cacheStorage),r&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(t).method===k.Constants.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=C.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw S.ClientConfigurationError.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(k.Constants.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(k.Constants.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),m.UrlUtils.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===k.Constants.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==k.Constants.interactionTypePopup)throw I.ClientAuthError.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===k.Constants.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==k.Constants.interactionTypePopup)throw I.ClientAuthError.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=v.RequestUtils.validateRequest(e,!0,this.clientId,k.Constants.interactionTypeRedirect);this.acquireTokenInteractive(k.Constants.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=v.RequestUtils.validateRequest(e,!1,this.clientId,k.Constants.interactionTypeRedirect);this.acquireTokenInteractive(k.Constants.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=v.RequestUtils.validateRequest(e,!0,this.clientId,k.Constants.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,R.API_EVENT_IDENTIFIER.LoginPopup);return new Promise((function(e,n){t.acquireTokenInteractive(k.Constants.interactionTypePopup,!0,r,e,n)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=v.RequestUtils.validateRequest(e,!1,this.clientId,k.Constants.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,R.API_EVENT_IDENTIFIER.AcquireTokenPopup);return new Promise((function(e,n){t.acquireTokenInteractive(k.Constants.interactionTypePopup,!1,r,e,n)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i,s=this;this.logger.verbose("AcquireTokenInteractive has been called"),g.WindowUtils.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(n){var c=t?I.ClientAuthError.createLoginInProgressError():I.ClientAuthError.createAcquireTokenInProgressError(),u=w.buildResponseStateOnly(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,c,u,o)}if(e===k.Constants.interactionTypeRedirect&&this.cacheStorage.setItem(k.TemporaryCacheKeys.REDIRECT_REQUEST,""+k.Constants.inProgress+k.Constants.resourceDelimiter+r.state),r&&r.account&&!t?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),i||a.ServerRequestParameters.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(i,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");u=w.buildResponseStateOnly(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,I.ClientAuthError.createUserLoginRequiredError(),u,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then((function(t){s.silentLogin=!1,s.logger.info("Unified cache call is successful"),s.authResponseHandler(e,t,n)}),(function(i){s.silentLogin=!1,s.logger.error("Error occurred during unified cache ATS: "+i),s.acquireTokenHelper(null,e,t,r,n,o)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,o,i,s){return n.__awaiter(this,void 0,Promise,(function(){var c,u,h,d,p,f,y,v,E,T;return n.__generator(this,(function(n){switch(n.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),c=o.scopes?o.scopes.join(" ").toLowerCase():k.Constants.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+c),h=o&&o.authority?C.AuthorityFactory.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance,n.label=1;case 1:return n.trys.push([1,11,,12]),h.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,C.AuthorityFactory.saveMetadataFromNetwork(h,this.telemetryManager,o.correlationId)]);case 2:return n.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),n.label=4;case 4:if(p=r?k.ResponseTypes.id_token:this.getTokenType(e,o.scopes),f=o.redirectStartPage||window.location.href,u=new a.ServerRequestParameters(h,this.clientId,p,this.getRedirectUri(o&&o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(u,e,r,f),this.logger.verbose("Updating cache entries"),u.populateQueryParams(e,o),this.logger.verbose("Query parameters populated from account"),y=m.UrlUtils.createNavigateUrl(u)+k.Constants.response_mode_fragment,t===k.Constants.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.STATE_ACQ_TOKEN,o.state),u.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+u.state));else{if(t!==k.Constants.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),I.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(u.state),window.requestType=r?k.Constants.login:k.Constants.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+u.state),this.registerCallback(u.state,c,i,s)}if(t!==k.Constants.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{d=this.openPopup(y,"msal",k.Constants.popUpWidth,k.Constants.popUpHeight),g.WindowUtils.trackPopup(d)}catch(e){if(this.logger.info(I.ClientAuthErrorMessage.popUpWindowError.code+":"+I.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR,I.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR_DESC,I.ClientAuthErrorMessage.popUpWindowError.desc),s)return s(I.ClientAuthError.createPopupWindowError()),[2]}if(!d)return[3,8];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,g.WindowUtils.monitorPopupForHash(d,this.config.system.loadFrameTimeout,y,this.logger)];case 6:return v=n.sent(),this.handleAuthenticationResponse(v),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",v),g.WindowUtils.closePopups(),[3,8];case 7:return E=n.sent(),s&&s(E),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",E.errorCode+k.Constants.resourceDelimiter+E.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),d.close()),[3,8];case 8:return[3,10];case 9:o.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==o.onRedirectNavigate(y)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(y)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(y)),n.label=10;case 10:return[3,12];case 11:return T=n.sent(),this.logger.error(T),this.cacheStorage.resetTempCacheItems(o.state),this.authErrorHandler(t,I.ClientAuthError.createEndpointResolutionError(T.toString),w.buildResponseStateOnly(o.state),s),d&&d.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw S.ClientConfigurationError.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw S.ClientConfigurationError.createSsoSilentError();return this.acquireTokenSilent(n.__assign(n.__assign({},e),{scopes:k.Constants.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=v.RequestUtils.validateRequest(e,!1,this.clientId,k.Constants.interactionTypeSilent),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,R.API_EVENT_IDENTIFIER.AcquireTokenSilent),i=v.RequestUtils.createRequestSignature(r);return new Promise((function(e,o){return n.__awaiter(t,void 0,void 0,(function(){var t,s,c,u,l,h,y,m,v,E,T;return n.__generator(this,(function(n){switch(n.label){case 0:if(g.WindowUtils.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(s=r.account,this.logger.verbose("Account set from request")):(s=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),c=this.cacheStorage.getItem(k.Constants.adalIdToken),!s&&!r.sid&&!r.loginHint&&p.StringUtils.isEmpty(c))return this.logger.info("User login is required"),[2,o(I.ClientAuthError.createUserLoginRequiredError())];if(u=this.getTokenType(s,r.scopes),this.logger.verbose("Response type: "+u),l=new a.ServerRequestParameters(C.AuthorityFactory.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,u,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),a.ServerRequestParameters.isSSOParam(r)||s?(l.populateQueryParams(s,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):s||p.StringUtils.isEmpty(c)?this.logger.verbose("No additional query parameters added"):(h=f.TokenUtils.extractIdToken(c),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),l.populateQueryParams(s,null,h,!0)),!(y=r.claimsRequest||l.claimsValue)&&!r.forceRefresh)try{v=this.getCachedToken(l,s)}catch(e){m=e}return v?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(v.scopes)),e(v),[2,null]):[3,1];case 1:return m?(this.logger.infoPii(m.errorCode+":"+m.errorMessage),o(m),[2,null]):[3,2];case 2:E=void 0,E=y?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(E),l.authorityInstance||(l.authorityInstance=r.authority?C.AuthorityFactory.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+l.authority),n.label=3;case 3:return n.trys.push([3,7,,8]),l.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,C.AuthorityFactory.saveMetadataFromNetwork(l.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return n.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),n.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,o)):r.scopes&&d.ScopeSet.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,o,s,l)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,o,s,l)),[3,8];case 7:return T=n.sent(),this.logger.error(T),o(I.ClientAuthError.createEndpointResolutionError(T.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,u=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c+", scrollbars=yes");if(!l)throw I.ClientAuthError.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.cacheStorage.setInteractionInProgress(!1),I.ClientAuthError.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var o,i,a,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return o=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.RENEW_STATUS,o),k.Constants.inProgress),this.config.system.navigateFrameWait?[4,g.WindowUtils.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=n.sent(),[3,3];case 2:a=g.WindowUtils.loadFrameSync(e,t,this.logger),n.label=3;case 3:i=a,n.label=4;case 4:return n.trys.push([4,6,,7]),[4,g.WindowUtils.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(s=n.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw c=n.sent(),this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.RENEW_STATUS,o))===k.Constants.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,c),this.cacheStorage.removeItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.RENEW_STATUS,o))),g.WindowUtils.removeHiddenIframe(i),c;case 7:return g.WindowUtils.removeHiddenIframe(i),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||p.StringUtils.isEmpty(e))throw this.logger.info("Navigate url is empty"),_.AuthError.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){delete window.activeRenewals[t];for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),_.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,o,i,a,s;return n.__generator(this,(function(n){switch(n.label){case 0:t=e||O.CryptoUtils.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,R.API_EVENT_IDENTIFIER.Logout),this.clearCache(),this.account=null,n.label=1;case 1:return n.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,C.AuthorityFactory.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return n.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),n.label=4;case 4:return o="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),a=void 0,this.authorityInstance.EndSessionEndpoint?(a=this.authorityInstance.EndSessionEndpoint+"?"+o+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(a=this.authority+"oauth2/v2.0/logout?"+o+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(a),[3,6];case 5:return s=n.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,s.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(k.Constants.clientId,k.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(k.Constants.clientId,k.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),m.UrlUtils.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var n,o,i=t;i||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),i=this.getResponseState(e));try{n=this.saveTokenFromHash(e,i)}catch(e){o=e}try{this.cacheStorage.clearMsalCookie(i.state);var a=this.getAccountState(i.state);if(n){if(i.requestType===k.Constants.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+k.ServerHashParamKeys.ACCESS_TOKEN),n.tokenType=k.ServerHashParamKeys.ACCESS_TOKEN):i.requestType===k.Constants.login&&(this.logger.verbose("Response tokenType set to "+k.ServerHashParamKeys.ID_TOKEN),n.tokenType=k.ServerHashParamKeys.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=n)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=w.buildResponseStateOnly(a),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(i.state);this.logger.verbose("Calling callback provided to processCallback"),r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),I.ClientAuthError.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),g.WindowUtils.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=m.UrlUtils.removeHashFromUrl(window.location.href),o=m.UrlUtils.removeHashFromUrl(r);if(n!==o)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+o),void window.location.assign(""+o+e);this.logger.verbose("Current url matches login request url");var i=m.UrlUtils.GetUrlComponents(r);i.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=i.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=m.UrlUtils.deserializeHash(e);if(!r)throw _.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(k.ServerHashParamKeys.STATE))throw _.AuthError.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var n=v.RequestUtils.parseLibraryState(r.state);if((t={requestType:k.Constants.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=k.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=k.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,n=this.getCachedIdToken(e,t),o=this.getCachedAccessToken(e,t,r),i=this.getAccountState(e.state);return E.ResponseUtils.buildAuthResponse(n,o,e,t,r,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,r,n){var o,i=this;return 1===(o=m.UrlUtils.isCommonAuthority(e)||m.UrlUtils.isOrganizationsAuthority(e)||m.UrlUtils.isConsumersAuthority(e)?U.AuthCacheUtils.filterTokenCacheItemsByDomain(t,m.UrlUtils.GetUrlComponents(e).HostNameAndPort):U.AuthCacheUtils.filterTokenCacheItemsByAuthority(t,e)).length?o[0]:o.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),o.forEach((function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+n+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,o=this.getTokenCacheItemByAuthority(n,r,null,k.ServerHashParamKeys.ID_TOKEN);if(o){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(o)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=o.value;return i?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),i?new u.IdToken(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),o=U.AuthCacheUtils.filterTokenCacheItemsByScope(n,r),i=e.authority||this.authority,a=this.getTokenCacheItemByAuthority(i,o,r,k.ServerHashParamKeys.ACCESS_TOKEN);if(a){if(e.authorityInstance=C.AuthorityFactory.CreateInstance(a.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(a)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var s=t||this.getAccount();if(!s)throw _.AuthError.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:k.ServerHashParamKeys.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:a.value.accessToken,scopes:a.key.scopes.split(" "),expiresOn:new Date(1e3*Number(a.value.expiresIn)),account:s,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return f.TokenUtils.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(k.Constants.adalIdToken);return p.StringUtils.isEmpty(e)?null:f.TokenUtils.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=g.WindowUtils.generateFrameName(k.FramePrefix.TOKEN_FRAME,e);g.WindowUtils.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),k.Constants.prompt)+k.Constants.prompt_none+k.Constants.response_mode_fragment;window.renewStates.push(o.state),window.requestType=k.Constants.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=g.WindowUtils.generateFrameName(k.FramePrefix.ID_TOKEN_FRAME,e);g.WindowUtils.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=m.UrlUtils.urlRemoveQueryStringParameter(m.UrlUtils.createNavigateUrl(o),k.Constants.prompt)+k.Constants.prompt_none+k.Constants.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=k.Constants.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=k.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.saveToken=function(e,t,r,n,a){var s=new o.AccessTokenKey(t,this.clientId,r,n.uid,n.utid),c=new i.AccessTokenValue(e.accessToken,e.idToken.rawIdToken,a.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(s),JSON.stringify(c)),a?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*a)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,r,o,i){this.logger.verbose("SaveIdToken has been called");var a=n.__assign({},e);a.scopes=k.Constants.oidcScopes,a.accessToken=r[k.ServerHashParamKeys.ID_TOKEN];var s=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(a,t,undefined,o,s)},e.prototype.saveAccessToken=function(e,t,r,o){this.logger.verbose("SaveAccessToken has been called");var i=n.__assign({},e),a=r[k.ServerHashParamKeys.SCOPE],s=a.split(" "),c=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var u=0;u<c.length;u++){var l=c[u];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var h=l.key.scopes.split(" ");d.ScopeSet.isIntersectingScopes(h,s)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}i.accessToken=r[k.ServerHashParamKeys.ACCESS_TOKEN],i.scopes=s;var p=y.TimeUtils.parseExpiresIn(r[k.ServerHashParamKeys.EXPIRES_IN]),g=v.RequestUtils.parseLibraryState(r[k.ServerHashParamKeys.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,a,o,g)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=m.UrlUtils.deserializeHash(e),i="",a="",d=null;if(o.hasOwnProperty(k.ServerHashParamKeys.ERROR_DESCRIPTION)||o.hasOwnProperty(k.ServerHashParamKeys.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+o[k.ServerHashParamKeys.ERROR]+"; Error description: "+o[k.ServerHashParamKeys.ERROR_DESCRIPTION]),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR,o[k.ServerHashParamKeys.ERROR]),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR_DESC,o[k.ServerHashParamKeys.ERROR_DESCRIPTION]),t.requestType===k.Constants.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(k.ErrorCacheKeys.LOGIN_ERROR,o[k.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+o[k.ServerHashParamKeys.ERROR]),i=l.AuthCache.generateAuthorityKey(t.state)),t.requestType===k.Constants.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),i=l.AuthCache.generateAuthorityKey(t.state);var g=this.getAccount(),f=void 0;g&&!p.StringUtils.isEmpty(g.homeAccountIdentifier)?(f=g.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(f=k.Constants.no_account,this.logger.verbose("AccountId is set as no_account")),a=l.AuthCache.generateAcquireTokenAccountKey(f,t.state)}var y=o[k.ServerHashParamKeys.ERROR],v=o[k.ServerHashParamKeys.ERROR_DESCRIPTION];r=A.InteractionRequiredAuthError.isInteractionRequiredError(y)||A.InteractionRequiredAuthError.isInteractionRequiredError(v)?new A.InteractionRequiredAuthError(o[k.ServerHashParamKeys.ERROR],o[k.ServerHashParamKeys.ERROR_DESCRIPTION]):new b.ServerError(o[k.ServerHashParamKeys.ERROR],o[k.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(k.ServerHashParamKeys.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.SESSION_STATE,t.state),o[k.ServerHashParamKeys.SESSION_STATE])),n.accountState=this.getAccountState(t.state);var C=void 0;if(o.hasOwnProperty(k.ServerHashParamKeys.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[k.ServerHashParamKeys.ACCESS_TOKEN],o.hasOwnProperty(k.ServerHashParamKeys.SCOPE)&&(n.scopes=o[k.ServerHashParamKeys.SCOPE].split(" ")),o.hasOwnProperty(k.ServerHashParamKeys.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),d=new u.IdToken(o[k.ServerHashParamKeys.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),d=new u.IdToken(this.cacheStorage.getItem(k.PersistentCacheKeys.IDTOKEN))),n=E.ResponseUtils.setResponseIdToken(n,d);var T=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);this.logger.verbose("Got authority from cache"),o.hasOwnProperty(k.ServerHashParamKeys.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),C=new c.ClientInfo(o[k.ServerHashParamKeys.CLIENT_INFO],T)):this.authorityInstance.AuthorityType===s.AuthorityType.Adfs?C=c.ClientInfo.createClientInfoFromIdToken(d,T):this.logger.warning("ClientInfo not received in the response from AAD"),n.account=h.Account.createAccount(d,C),this.logger.verbose("Account object created from response");var S=void 0;n.account&&!p.StringUtils.isEmpty(n.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),S=n.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),S=k.Constants.no_account),a=l.AuthCache.generateAcquireTokenAccountKey(S,t.state);var w=l.AuthCache.generateAcquireTokenAccountKey(k.Constants.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var P=this.cacheStorage.getItem(a),R=void 0;p.StringUtils.isEmpty(P)?p.StringUtils.isEmpty(this.cacheStorage.getItem(w))||(this.logger.verbose("No acquireToken account retrieved from cache"),n=this.saveAccessToken(n,T,o,C)):(R=JSON.parse(P),this.logger.verbose("AcquireToken request account retrieved from cache"),n.account&&R&&h.Account.compareAccounts(n.account,R)?(n=this.saveAccessToken(n,T,o,C),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(k.ServerHashParamKeys.ID_TOKEN)){this.logger.info("Fragment has idToken"),d=new u.IdToken(o[k.ServerHashParamKeys.ID_TOKEN]);T=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(n=E.ResponseUtils.setResponseIdToken(n,d),o.hasOwnProperty(k.ServerHashParamKeys.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),C=new c.ClientInfo(o[k.ServerHashParamKeys.CLIENT_INFO],T)):this.authorityInstance.AuthorityType===s.AuthorityType.Adfs?C=c.ClientInfo.createClientInfoFromIdToken(d,T):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=h.Account.createAccount(d,C),n.account=this.account,this.logger.verbose("Account object created from response"),d&&d.nonce){this.logger.verbose("IdToken has nonce");var O=this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.NONCE_IDTOKEN,t.state),this.inCookie);d.nonce!==O?(this.account=null,this.cacheStorage.setItem(k.ErrorCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+O+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+O+", Actual Nonce: "+d.nonce),r=I.ClientAuthError.createNonceMismatchError(O,d.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(k.PersistentCacheKeys.IDTOKEN,o[k.ServerHashParamKeys.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(k.PersistentCacheKeys.CLIENT_INFO,C.encodeClientInfo(),this.inCookie),this.saveIdToken(n,T,o,C,d))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=I.ClientAuthError.createInvalidIdTokenError(d),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),i=t.state,a=t.state;var N=this.cacheStorage.getItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+N+", Actual State: "+t.state),r=I.ClientAuthError.createInvalidStateError(t.state,N),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(k.ErrorCacheKeys.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw _.AuthError.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=l.AuthCache.generateAuthorityKey(e),i=r.getItem(o,t);return p.StringUtils.isEmpty(i)?i:m.UrlUtils.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(k.PersistentCacheKeys.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(k.PersistentCacheKeys.CLIENT_INFO,this.inCookie);if(!p.StringUtils.isEmpty(e)&&!p.StringUtils.isEmpty(t)){var r=new u.IdToken(e),n=new c.ClientInfo(t,"");return this.account=h.Account.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(k.Constants.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(k.Constants.clientId,k.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var n=new u.IdToken(t[r].value.idToken),o=new c.ClientInfo(t[r].value.homeAccountIdentifier,""),i=h.Account.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:C.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(o,e),c=new a.ServerRequestParameters(i,this.clientId,s,this.getRedirectUri(),e,r,n);return this.getCachedToken(c,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?m.UrlUtils.getHostFromUri(e)===m.UrlUtils.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw S.ClientConfigurationError.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=h.Account.compareAccounts(e,this.getAccount());return a.ServerRequestParameters.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):k.Constants.no_account,n=l.AuthCache.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=l.AuthCache.generateAuthorityKey(e);this.cacheStorage.setItem(r,m.UrlUtils.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(l.AuthCache.generateTemporaryCacheKey(k.TemporaryCacheKeys.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return p.StringUtils.isEmpty(e.homeAccountIdentifier)?k.Constants.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:k.Constants.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return P.default.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw S.ClientConfigurationError.createTelemetryConfigError(e);var i={platform:{applicationName:r,applicationVersion:n},clientId:t};return new P.default(i,o,this.logger)},e}();t.UserAgentApplication=M},767:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.XhrClient=void 0;var n=r(91),o=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise((function(r,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),a.onload=function(){var e;(a.status<200||a.status>=300)&&i(o.handleError(a.responseText));try{e=JSON.parse(a.responseText)}catch(e){i(o.handleError(a.responseText))}var t={statusCode:a.status,body:e};r(t)},a.onerror=function(){i(a.status)},t!==n.NetworkRequestType.GET)throw"not implemented";a.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}();t.XhrClient=o},660:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Authority=t.AuthorityType=void 0;var n,o=r(795),i=r(550),a=r(767),s=r(741),c=r(405),u=r(91);!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(n=t.AuthorityType||(t.AuthorityType={}));var l=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=s.UrlUtils.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===u.Constants.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?n.Adfs:n.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=s.UrlUtils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=s.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===n.Adfs?""+this.CanonicalAuthority+u.WELL_KNOWN_SUFFIX:this.CanonicalAuthority+"v2.0/"+u.WELL_KNOWN_SUFFIX},enumerable:!1,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.ClientConfigurationErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.ClientConfigurationErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.ClientConfigurationErrorMessage.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new a.XhrClient,o=u.NetworkRequestType.GET,i=t.createAndStartHttpEvent(r,o,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,o,!0).then((function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw i.serverErrorCode=e,t.stopEvent(i),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return o.__awaiter(this,void 0,Promise,(function(){var r,n,a;return o.__generator(this,(function(o){switch(o.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==c.TrustedAuthority.getTrustedHostList().length?[3,2]:[4,c.TrustedAuthority.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:o.sent(),o.label=2;case 2:if(!c.TrustedAuthority.IsInTrustedHostList(r))throw i.ClientConfigurationError.createUntrustedAuthorityError(r);o.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),a=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return a.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}();t.Authority=l},951:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorityFactory=void 0;var n=r(795),o=r(660),i=r(454),a=r(550),s=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return o=n.sent(),this.metadataMap.set(e.CanonicalAuthority,o),[2,o]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw a.ClientConfigurationError.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw a.ClientConfigurationError.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return i.StringUtils.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new o.Authority(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();t.AuthorityFactory=s},405:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TrustedAuthority=void 0;var n=r(795),o=r(767),i=r(91),a=r(741),s=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var a,s,c,u;return n.__generator(this,(function(n){return a=new o.XhrClient,s=i.NetworkRequestType.GET,c=""+i.AAD_INSTANCE_DISCOVERY_ENDPOINT+e+"oauth2/v2.0/authorize",u=t.createAndStartHttpEvent(r,s,c,"getAliases"),[2,a.sendRequestAsync(c,s,!0).then((function(e){return u.httpResponseStatus=e.statusCode,t.stopEvent(u),e.body.metadata})).catch((function(e){throw u.serverErrorCode=e,t.stopEvent(u),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,r,o){return n.__awaiter(this,void 0,Promise,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getAliases(t,r,o)];case 1:return n.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),i=a.UrlUtils.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(i)&&e.TrustedHostList.push(i.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();t.TrustedAuthority=s},644:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenCacheItem=void 0;var r=function(e,t){this.key=e,this.value=t};t.AccessTokenCacheItem=r},29:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenKey=void 0;var n=r(453),o=r(741),i=function(e,t,r,i,a){this.authority=o.UrlUtils.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.CryptoUtils.base64Encode(i)+"."+n.CryptoUtils.base64Encode(a)};t.AccessTokenKey=i},192:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenValue=void 0;var r=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n};t.AccessTokenValue=r},226:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCache=void 0;var n=r(795),o=r(91),i=r(644),a=r(96),s=r(52),c=r(454),u=r(881),l=r(356),h=function(e){function t(t,r,n){var i=e.call(this,r)||this;return i.temporaryCache=new a.BrowserStorage(o.SESSION_STORAGE),i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(n),i}return n.__extends(t,e),t.prototype.migrateCacheEntries=function(t){var r,n=this,i=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.IDTOKEN,a=o.Constants.cachePrefix+"."+o.PersistentCacheKeys.CLIENT_INFO,s=o.Constants.cachePrefix+"."+o.ErrorCacheKeys.ERROR,c=o.Constants.cachePrefix+"."+o.ErrorCacheKeys.ERROR_DESC,l=e.prototype.getItem.call(this,i);if(l)try{r=new u.IdToken(l)}catch(e){return}if(r&&r.claims&&r.claims.aud===this.clientId){var h=[l,e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,c)];[o.PersistentCacheKeys.IDTOKEN,o.PersistentCacheKeys.CLIENT_INFO,o.ErrorCacheKeys.ERROR,o.ErrorCacheKeys.ERROR_DESC].forEach((function(e,r){return n.duplicateCacheEntry(e,h[r],t)}))}},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+o.Constants.cachePrefix)||0===e.indexOf(o.Constants.adalIdToken)?e:t?o.Constants.cachePrefix+"."+this.clientId+"."+e:o.Constants.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,r,n){var i=c.StringUtils.validateAndParseJsonCacheKey(e);if(!i)return null;var a=e.match(t)&&e.match(r),s=!1;switch(n){case o.ServerHashParamKeys.ACCESS_TOKEN:s=!!e.match(o.Constants.scopes);break;case o.ServerHashParamKeys.ID_TOKEN:s=!e.match(o.Constants.scopes)}return a&&s?i:null},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.setTemporaryItem=function(e,t,r){this.temporaryCache.setItem(this.generateCacheKey(e,!0),t,r)},t.prototype.getTemporaryItem=function(e,t){return this.temporaryCache.getItem(this.generateCacheKey(e,!0),t)},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(o.Constants.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&s.RequestUtils.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),a=window[this.cacheLocation];n&&!i&&Object.keys(a).forEach((function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))})),this.setInteractionInProgress(!1),this.removeItem(o.TemporaryCacheKeys.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,r){var n=this;return Object.keys(window[this.cacheLocation]).reduce((function(o,a){var s=n.matchKeyForType(a,e,t,r);if(s){var c=n.getItem(a);if(c)try{var u=new i.AccessTokenCacheItem(s,JSON.parse(c));return o.concat([u])}catch(e){return o}}return o}),[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,o.ServerHashParamKeys.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,o.ServerHashParamKeys.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var r=this.getAllAccessTokens(e,t),o=this.getAllIdTokens(e,t);return n.__spreadArrays(r,o)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(o.TemporaryCacheKeys.INTERACTION_STATUS,!1))},t.prototype.setInteractionInProgress=function(e){if(e){if(this.isInteractionInProgress(!1))throw l.ClientAuthError.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(o.TemporaryCacheKeys.INTERACTION_STATUS,!1),this.clientId)}else!e&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(o.TemporaryCacheKeys.INTERACTION_STATUS,!1))},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(o.TemporaryCacheKeys.RENEW_STATUS,e));return!(!r||r!==o.Constants.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(o.TemporaryCacheKeys.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.TemporaryCacheKeys.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.TemporaryCacheKeys.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.TemporaryCacheKeys.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach((function(t){var r=t.trim().split("=")[0];r.indexOf(o.Constants.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)}))},t.generateAcquireTokenAccountKey=function(e,t){var r=s.RequestUtils.parseLibraryState(t).id;return""+o.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+o.Constants.resourceDelimiter+e+o.Constants.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(o.TemporaryCacheKeys.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=s.RequestUtils.parseLibraryState(t).id;return""+e+o.Constants.resourceDelimiter+r},t}(a.BrowserStorage);t.AuthCache=h},96:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserStorage=void 0;var n=r(550),o=r(986),i=function(){function e(e){if(!window)throw o.AuthError.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!==window[e]))throw n.ClientConfigurationError.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}();t.BrowserStorage=i},986:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthError=t.AuthErrorMessage=void 0;var n=r(795);t.AuthErrorMessage={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};var o=function(e){function r(t,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,r.prototype),o.errorCode=t,o.errorMessage=n,o.name="AuthError",o}return n.__extends(r,e),r.createUnexpectedError=function(e){return new r(t.AuthErrorMessage.unexpectedError.code,t.AuthErrorMessage.unexpectedError.desc+": "+e)},r.createNoWindowObjectError=function(e){return new r(t.AuthErrorMessage.noWindowObjectError.code,t.AuthErrorMessage.noWindowObjectError.desc+" "+e)},r}(Error);t.AuthError=o},356:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ClientAuthError=t.ClientAuthErrorMessage=void 0;var n=r(795),o=r(986),i=r(454);t.ClientAuthErrorMessage={endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}};var a=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createEndpointResolutionError=function(e){var n=t.ClientAuthErrorMessage.endpointResolutionError.desc;return e&&!i.StringUtils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.endpointResolutionError.code,n)},r.createPopupWindowError=function(e){var n=t.ClientAuthErrorMessage.popUpWindowError.desc;return e&&!i.StringUtils.isEmpty(e)&&(n+=" Details: "+e),new r(t.ClientAuthErrorMessage.popUpWindowError.code,n)},r.createTokenRenewalTimeoutError=function(){return new r(t.ClientAuthErrorMessage.tokenRenewalError.code,t.ClientAuthErrorMessage.tokenRenewalError.desc)},r.createInvalidIdTokenError=function(e){return new r(t.ClientAuthErrorMessage.invalidIdToken.code,t.ClientAuthErrorMessage.invalidIdToken.desc+" Given token: "+e)},r.createInvalidStateError=function(e,n){return new r(t.ClientAuthErrorMessage.invalidStateError.code,t.ClientAuthErrorMessage.invalidStateError.desc+" "+e+", state expected : "+n+".")},r.createNonceMismatchError=function(e,n){return new r(t.ClientAuthErrorMessage.nonceMismatchError.code,t.ClientAuthErrorMessage.nonceMismatchError.desc+" "+e+", nonce expected : "+n+".")},r.createLoginInProgressError=function(){return new r(t.ClientAuthErrorMessage.loginProgressError.code,t.ClientAuthErrorMessage.loginProgressError.desc)},r.createAcquireTokenInProgressError=function(){return new r(t.ClientAuthErrorMessage.acquireTokenProgressError.code,t.ClientAuthErrorMessage.acquireTokenProgressError.desc)},r.createUserCancelledError=function(){return new r(t.ClientAuthErrorMessage.userCancelledError.code,t.ClientAuthErrorMessage.userCancelledError.desc)},r.createErrorInCallbackFunction=function(e){return new r(t.ClientAuthErrorMessage.callbackError.code,t.ClientAuthErrorMessage.callbackError.desc+" "+e+".")},r.createUserLoginRequiredError=function(){return new r(t.ClientAuthErrorMessage.userLoginRequiredError.code,t.ClientAuthErrorMessage.userLoginRequiredError.desc)},r.createUserDoesNotExistError=function(){return new r(t.ClientAuthErrorMessage.userDoesNotExistError.code,t.ClientAuthErrorMessage.userDoesNotExistError.desc)},r.createClientInfoDecodingError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoDecodingError.code,t.ClientAuthErrorMessage.clientInfoDecodingError.desc+" Failed with error: "+e)},r.createClientInfoNotPopulatedError=function(e){return new r(t.ClientAuthErrorMessage.clientInfoNotPopulatedError.code,t.ClientAuthErrorMessage.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},r.createIdTokenNullOrEmptyError=function(e){return new r(t.ClientAuthErrorMessage.nullOrEmptyIdToken.code,t.ClientAuthErrorMessage.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},r.createIdTokenParsingError=function(e){return new r(t.ClientAuthErrorMessage.idTokenNotParsed.code,t.ClientAuthErrorMessage.idTokenNotParsed.desc+" Failed with error: "+e)},r.createTokenEncodingError=function(e){return new r(t.ClientAuthErrorMessage.tokenEncodingError.code,t.ClientAuthErrorMessage.tokenEncodingError.desc+" Attempted to decode: "+e)},r.createInvalidInteractionTypeError=function(){return new r(t.ClientAuthErrorMessage.invalidInteractionType.code,t.ClientAuthErrorMessage.invalidInteractionType.desc)},r.createCacheParseError=function(e){var n="invalid key: "+e+", "+t.ClientAuthErrorMessage.cacheParseError.desc;return new r(t.ClientAuthErrorMessage.cacheParseError.code,n)},r.createBlockTokenRequestsInHiddenIframeError=function(){return new r(t.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code,t.ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc)},r}(o.AuthError);t.ClientAuthError=a},550:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ClientConfigurationError=t.ClientConfigurationErrorMessage=void 0;var n=r(795),o=r(356);t.ClientConfigurationErrorMessage={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createNoSetConfigurationError=function(){return new r(t.ClientConfigurationErrorMessage.configurationNotSet.code,""+t.ClientConfigurationErrorMessage.configurationNotSet.desc)},r.createStorageNotSupportedError=function(e){return new r(t.ClientConfigurationErrorMessage.storageNotSupported.code,t.ClientConfigurationErrorMessage.storageNotSupported.desc+" Given location: "+e)},r.createRedirectCallbacksNotSetError=function(){return new r(t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.code,t.ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc)},r.createInvalidCallbackObjectError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidCallbackObject.code,t.ClientConfigurationErrorMessage.invalidCallbackObject.desc+" Given value for callback function: "+e)},r.createEmptyScopesArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.emptyScopes.code,t.ClientConfigurationErrorMessage.emptyScopes.desc+" Given value: "+e+".")},r.createScopesNonArrayError=function(e){return new r(t.ClientConfigurationErrorMessage.nonArrayScopes.code,t.ClientConfigurationErrorMessage.nonArrayScopes.desc+" Given value: "+e+".")},r.createScopesRequiredError=function(e){return new r(t.ClientConfigurationErrorMessage.scopesRequired.code,t.ClientConfigurationErrorMessage.scopesRequired.desc+" Given value: "+e)},r.createInvalidPromptError=function(e){return new r(t.ClientConfigurationErrorMessage.invalidPrompt.code,t.ClientConfigurationErrorMessage.invalidPrompt.desc+" Given value: "+e)},r.createClaimsRequestParsingError=function(e){return new r(t.ClientConfigurationErrorMessage.claimsRequestParsingError.code,t.ClientConfigurationErrorMessage.claimsRequestParsingError.desc+" Given value: "+e)},r.createEmptyRequestError=function(){var e=t.ClientConfigurationErrorMessage.emptyRequestError;return new r(e.code,e.desc)},r.createInvalidCorrelationIdError=function(){return new r(t.ClientConfigurationErrorMessage.invalidCorrelationIdError.code,t.ClientConfigurationErrorMessage.invalidCorrelationIdError.desc)},r.createKnownAuthoritiesNotSetError=function(){return new r(t.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code,t.ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc)},r.createInvalidAuthorityTypeError=function(){return new r(t.ClientConfigurationErrorMessage.invalidAuthorityType.code,t.ClientConfigurationErrorMessage.invalidAuthorityType.desc)},r.createUntrustedAuthorityError=function(e){return new r(t.ClientConfigurationErrorMessage.untrustedAuthority.code,t.ClientConfigurationErrorMessage.untrustedAuthority.desc+" Provided Authority: "+e)},r.createTelemetryConfigError=function(e){var n=t.ClientConfigurationErrorMessage.telemetryConfigError,o=n.code,i=n.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new r(o,i+" mising values: "+Object.keys(a).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+a[r]+")"])}),[]).join(","))},r.createSsoSilentError=function(){return new r(t.ClientConfigurationErrorMessage.ssoSilentError.code,t.ClientConfigurationErrorMessage.ssoSilentError.desc)},r.createInvalidAuthorityMetadataError=function(){return new r(t.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code,t.ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc)},r}(o.ClientAuthError);t.ClientConfigurationError=i},961:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionRequiredAuthError=t.InteractionRequiredAuthErrorMessage=void 0;var n=r(795),o=r(447);t.InteractionRequiredAuthErrorMessage={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.isInteractionRequiredError=function(e){var r=[t.InteractionRequiredAuthErrorMessage.interactionRequired.code,t.InteractionRequiredAuthErrorMessage.consentRequired.code,t.InteractionRequiredAuthErrorMessage.loginRequired.code];return e&&r.indexOf(e)>-1},r.createLoginRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.loginRequired.code,e)},r.createInteractionRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.interactionRequired.code,e)},r.createConsentRequiredAuthError=function(e){return new r(t.InteractionRequiredAuthErrorMessage.consentRequired.code,e)},r}(o.ServerError);t.InteractionRequiredAuthError=i},447:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ServerError=t.ServerErrorMessage=void 0;var n=r(795),o=r(986);t.ServerErrorMessage={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};var i=function(e){function r(t,n){var o=e.call(this,t,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,r.prototype),o}return n.__extends(r,e),r.createServerUnavailableError=function(){return new r(t.ServerErrorMessage.serverUnavailable.code,t.ServerErrorMessage.serverUnavailable.desc)},r.createUnknownServerError=function(e){return new r(t.ServerErrorMessage.unknownServerError.code,e)},r}(o.AuthError);t.ServerError=i},700:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.name=void 0,t.name="msal",t.version="1.4.18"},663:function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.API_EVENT_IDENTIFIER=t.API_CODE=t.EVENT_KEYS=void 0;var o,i,a=r(795),s=a.__importDefault(r(336)),c=r(810),u=r(847);t.EVENT_KEYS={AUTHORITY:u.prependEventNamePrefix("authority"),AUTHORITY_TYPE:u.prependEventNamePrefix("authority_type"),PROMPT:u.prependEventNamePrefix("ui_behavior"),TENANT_ID:u.prependEventNamePrefix("tenant_id"),USER_ID:u.prependEventNamePrefix("user_id"),WAS_SUCESSFUL:u.prependEventNamePrefix("was_successful"),API_ERROR_CODE:u.prependEventNamePrefix("api_error_code"),LOGIN_HINT:u.prependEventNamePrefix("login_hint")},function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(o=t.API_CODE||(t.API_CODE={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(i=t.API_EVENT_IDENTIFIER||(t.API_EVENT_IDENTIFIER={}));var l=((n={})[i.AcquireTokenSilent]=o.AcquireTokenSilent,n[i.AcquireTokenPopup]=o.AcquireTokenPopup,n[i.AcquireTokenRedirect]=o.AcquireTokenRedirect,n[i.LoginPopup]=o.LoginPopup,n[i.LoginRedirect]=o.LoginRedirect,n[i.Logout]=o.Logout,n),h=function(e){function r(t,r,n){var o=e.call(this,u.prependEventNamePrefix("api_event"),t,n)||this;return n&&(o.apiCode=l[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return a.__extends(r,e),Object.defineProperty(r.prototype,"apiEventIdentifier",{set:function(e){this.event[c.TELEMETRY_BLOB_EVENT_NAMES.ApiTelemIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"apiCode",{set:function(e){this.event[c.TELEMETRY_BLOB_EVENT_NAMES.ApiIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"authority",{set:function(e){this.event[t.EVENT_KEYS.AUTHORITY]=u.scrubTenantFromUri(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"apiErrorCode",{set:function(e){this.event[t.EVENT_KEYS.API_ERROR_CODE]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tenantId",{set:function(e){this.event[t.EVENT_KEYS.TENANT_ID]=this.piiEnabled&&e?u.hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"accountId",{set:function(e){this.event[t.EVENT_KEYS.USER_ID]=this.piiEnabled&&e?u.hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wasSuccessful",{get:function(){return!0===this.event[t.EVENT_KEYS.WAS_SUCESSFUL]},set:function(e){this.event[t.EVENT_KEYS.WAS_SUCESSFUL]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"loginHint",{set:function(e){this.event[t.EVENT_KEYS.LOGIN_HINT]=this.piiEnabled&&e?u.hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"authorityType",{set:function(e){this.event[t.EVENT_KEYS.AUTHORITY_TYPE]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"promptType",{set:function(e){this.event[t.EVENT_KEYS.PROMPT]=e.toLowerCase()},enumerable:!1,configurable:!0}),r}(s.default);t.default=h},868:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(795),o=r(810),i=n.__importDefault(r(336)),a=r(847),s=function(e){function t(t,r,n,i){var s=e.call(this,a.prependEventNamePrefix("default_event"),r,"DefaultEvent")||this;return s.event[a.prependEventNamePrefix("client_id")]=n,s.event[a.prependEventNamePrefix("sdk_plaform")]=t.sdk,s.event[a.prependEventNamePrefix("sdk_version")]=t.sdkVersion,s.event[a.prependEventNamePrefix("application_name")]=t.applicationName,s.event[a.prependEventNamePrefix("application_version")]=t.applicationVersion,s.event[a.prependEventNamePrefix("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=s.getEventCount(a.prependEventNamePrefix("ui_event"),i),s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=s.getEventCount(a.prependEventNamePrefix("http_event"),i),s.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=s.getEventCount(a.prependEventNamePrefix("cache_event"),i),s}return n.__extends(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(i.default);t.default=s},140:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_KEYS=void 0;var n=r(795),o=n.__importDefault(r(336)),i=r(847),a=r(436);t.EVENT_KEYS={HTTP_PATH:i.prependEventNamePrefix("http_path"),USER_AGENT:i.prependEventNamePrefix("user_agent"),QUERY_PARAMETERS:i.prependEventNamePrefix("query_parameters"),API_VERSION:i.prependEventNamePrefix("api_version"),RESPONSE_CODE:i.prependEventNamePrefix("response_code"),O_AUTH_ERROR_CODE:i.prependEventNamePrefix("oauth_error_code"),HTTP_METHOD:i.prependEventNamePrefix("http_method"),REQUEST_ID_HEADER:i.prependEventNamePrefix("request_id_header"),SPE_INFO:i.prependEventNamePrefix("spe_info"),SERVER_ERROR_CODE:i.prependEventNamePrefix("server_error_code"),SERVER_SUB_ERROR_CODE:i.prependEventNamePrefix("server_sub_error_code"),URL:i.prependEventNamePrefix("url")};var s=function(e){function r(t,r){return e.call(this,i.prependEventNamePrefix("http_event"),t,r)||this}return n.__extends(r,e),Object.defineProperty(r.prototype,"url",{set:function(e){var r=i.scrubTenantFromUri(e);this.event[t.EVENT_KEYS.URL]=r&&r.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"httpPath",{set:function(e){this.event[t.EVENT_KEYS.HTTP_PATH]=i.scrubTenantFromUri(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"userAgent",{set:function(e){this.event[t.EVENT_KEYS.USER_AGENT]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"queryParams",{set:function(e){this.event[t.EVENT_KEYS.QUERY_PARAMETERS]=a.ServerRequestParameters.generateQueryParametersString(e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"apiVersion",{set:function(e){this.event[t.EVENT_KEYS.API_VERSION]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"httpResponseStatus",{set:function(e){this.event[t.EVENT_KEYS.RESPONSE_CODE]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"oAuthErrorCode",{set:function(e){this.event[t.EVENT_KEYS.O_AUTH_ERROR_CODE]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"httpMethod",{set:function(e){this.event[t.EVENT_KEYS.HTTP_METHOD]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"requestIdHeader",{set:function(e){this.event[t.EVENT_KEYS.REQUEST_ID_HEADER]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"speInfo",{set:function(e){this.event[t.EVENT_KEYS.SPE_INFO]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"serverErrorCode",{set:function(e){this.event[t.EVENT_KEYS.SERVER_ERROR_CODE]=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"serverSubErrorCode",{set:function(e){this.event[t.EVENT_KEYS.SERVER_SUB_ERROR_CODE]=e},enumerable:!1,configurable:!0}),r}(o.default);t.default=s},810:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TENANT_PLACEHOLDER=t.TELEMETRY_BLOB_EVENT_NAMES=t.ELAPSED_TIME_KEY=t.START_TIME_KEY=t.EVENT_NAME_KEY=t.EVENT_NAME_PREFIX=void 0,t.EVENT_NAME_PREFIX="msal.",t.EVENT_NAME_KEY="event_name",t.START_TIME_KEY="start_time",t.ELAPSED_TIME_KEY="elapsed_time",t.TELEMETRY_BLOB_EVENT_NAMES={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},t.TENANT_PLACEHOLDER="<tenant>"},336:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(795),o=r(810),i=r(847),a=r(453),s=function(){function e(e,t,r){var n;this.eventId=a.CryptoUtils.createNewGuid(),this.label=r,this.event=((n={})[i.prependEventNamePrefix(o.EVENT_NAME_KEY)]=e,n[i.prependEventNamePrefix(o.ELAPSED_TIME_KEY)]=-1,n[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[i.prependEventNamePrefix(o.ELAPSED_TIME_KEY)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp),i.endBrowserPerformanceMeasurement(this.displayName,this.perfStartMark,this.perfEndMark)},e.prototype.start=function(){this.startTimestamp=Date.now(),this.event[i.prependEventNamePrefix(o.START_TIME_KEY)]=this.startTimestamp,i.startBrowserPerformanceMeasurement(this.perfStartMark)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[i.prependEventNamePrefix(o.EVENT_NAME_KEY)]},enumerable:!1,configurable:!0}),e.prototype.get=function(){return n.__assign(n.__assign({},this.event),{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),e}();t.default=s},478:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(795),o=n.__importDefault(r(868)),i=r(91),a=n.__importDefault(r(663)),s=n.__importDefault(r(140)),c=r(700),u=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=n.__assign({sdk:i.Constants.libraryName,sdkVersion:c.version,networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=n.__spreadArrays(t||[],[e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var i=n.__spreadArrays(this.completedEvents[e],r);delete this.completedEvents[e];var a=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],i&&i.length){var s=new o.default(this.telemetryPlatform,e,this.clientId,a),c=n.__spreadArrays(i,[s]);this.telemetryEmitter(c.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new a.default(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new s.default(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,o){if(-1!==o.indexOf(e)){var i=t.inProgressEvents[o];return delete t.inProgressEvents[o],n.__spreadArrays(r,[i])}return r}),[])},e}();t.default=u},847:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.startBrowserPerformanceMeasurement=t.endBrowserPerformanceMeasurement=t.supportsBrowserPerformance=t.prependEventNamePrefix=t.hashPersonalIdentifier=t.scrubTenantFromUri=void 0;var n=r(810),o=r(453),i=r(741),a=r(660);t.scrubTenantFromUri=function(e){var t=i.UrlUtils.GetUrlComponents(e);if(a.Authority.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var o="tfp"===r[1]?2:1;o<r.length&&(r[o]=n.TENANT_PLACEHOLDER)}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},t.hashPersonalIdentifier=function(e){return o.CryptoUtils.base64Encode(e)},t.prependEventNamePrefix=function(e){return""+n.EVENT_NAME_PREFIX+(e||"")},t.supportsBrowserPerformance=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},t.endBrowserPerformanceMeasurement=function(e,r,n){t.supportsBrowserPerformance()&&(window.performance.mark(n),window.performance.measure(e,r,n),window.performance.clearMeasures(e),window.performance.clearMarks(r),window.performance.clearMarks(n))},t.startBrowserPerformanceMeasurement=function(e){t.supportsBrowserPerformance()&&window.performance.mark(e)}},49:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCacheUtils=void 0;var n=r(55),o=r(741),i=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var r=e.key.scopes.split(" "),o=n.ScopeSet.removeDefaultScopes(t);return 0===o.length?n.ScopeSet.containsScope(r,t):n.ScopeSet.containsScope(r,o)}))},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return o.UrlUtils.CanonicalizeUri(e.key.authority)===t}))},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return o.UrlUtils.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},e}();t.AuthCacheUtils=i},91:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FramePrefix=t.PromptState=t.NetworkRequestType=t.DisallowedEQParams=t.SSOTypes=t.WELL_KNOWN_SUFFIX=t.AAD_INSTANCE_DISCOVERY_ENDPOINT=t.DEFAULT_AUTHORITY=t.ErrorCacheKeys=t.PersistentCacheKeys=t.TemporaryCacheKeys=t.ResponseTypes=t.ServerHashParamKeys=t.SESSION_STORAGE=t.Constants=void 0;var r,n=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();t.Constants=n,t.SESSION_STORAGE="sessionStorage",function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(t.ServerHashParamKeys||(t.ServerHashParamKeys={})),t.ResponseTypes={id_token:"id_token",token:"token",id_token_token:"id_token token"},function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction.status",e.REDIRECT_REQUEST="redirect_request"}(t.TemporaryCacheKeys||(t.TemporaryCacheKeys={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(t.PersistentCacheKeys||(t.PersistentCacheKeys={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(t.ErrorCacheKeys||(t.ErrorCacheKeys={})),t.DEFAULT_AUTHORITY="https://login.microsoftonline.com/common/",t.AAD_INSTANCE_DISCOVERY_ENDPOINT=t.DEFAULT_AUTHORITY+"/discovery/instance?api-version=1.1&authorization_endpoint=",t.WELL_KNOWN_SUFFIX=".well-known/openid-configuration",function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(r=t.SSOTypes||(t.SSOTypes={})),t.DisallowedEQParams=[r.SID,r.LOGIN_HINT],t.NetworkRequestType={GET:"GET",POST:"POST"},t.PromptState={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},t.FramePrefix={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"}},453:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CryptoUtils=void 0;var r=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}();t.CryptoUtils=r},52:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RequestUtils=void 0;var n=r(795),o=r(91),i=r(550),a=r(55),s=r(454),c=r(453),u=r(78),l=r(356),h=function(){function e(){}return e.validateRequest=function(e,t,r,o){if(!t&&!e)throw i.ClientConfigurationError.createEmptyRequestError();var s,c;e&&(s=t?a.ScopeSet.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,a.ScopeSet.validateInputScope(s,!t),s=a.ScopeSet.translateClientIdIfSingleScope(s,r),this.validatePromptParameter(e.prompt),c=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var u=this.validateAndGenerateState(e&&e.state,o),l=this.validateAndGenerateCorrelationId(e&&e.correlationId);return n.__assign(n.__assign({},e),{extraQueryParameters:c,scopes:s,state:u,correlationId:l})},e.validatePromptParameter=function(e){if(e&&[o.PromptState.LOGIN,o.PromptState.SELECT_ACCOUNT,o.PromptState.CONSENT,o.PromptState.NONE].indexOf(e)<0)throw i.ClientConfigurationError.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=n.__assign({},e);return r?(t&&delete r[o.Constants.claims],o.DisallowedEQParams.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw i.ClientConfigurationError.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return s.StringUtils.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+o.Constants.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:c.CryptoUtils.createNewGuid(),ts:u.TimeUtils.now(),method:e},r=JSON.stringify(t);return c.CryptoUtils.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(o.Constants.resourceDelimiter)[0];if(c.CryptoUtils.isGuid(t))return{id:t,ts:u.TimeUtils.now(),method:o.Constants.interactionTypeRedirect};try{var r=c.CryptoUtils.base64Decode(t);return JSON.parse(r)}catch(t){throw l.ClientAuthError.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!c.CryptoUtils.isGuid(e))throw i.ClientConfigurationError.createInvalidCorrelationIdError();return c.CryptoUtils.isGuid(e)?e:c.CryptoUtils.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+o.Constants.resourceDelimiter+e.authority},e}();t.RequestUtils=h},756:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseUtils=void 0;var n=r(795),o=r(91),i=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.__assign(n.__assign({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,r,i,a,s,c){switch(i.responseType){case o.ResponseTypes.id_token:var u=n.__assign(n.__assign({},r),{tokenType:o.ServerHashParamKeys.ID_TOKEN,account:a,scopes:s,accountState:c});return(u=e.setResponseIdToken(u,t)).idToken?u:null;case o.ResponseTypes.id_token_token:var l=e.setResponseIdToken(r,t);return l&&l.accessToken&&l.idToken?l:null;case o.ResponseTypes.token:return e.setResponseIdToken(r,t);default:return null}},e}();t.ResponseUtils=i},454:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtils=void 0;var r=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}();t.StringUtils=r},78:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TimeUtils=void 0;var r=function(){function e(){}return e.parseExpiresIn=function(e){return parseInt(e||"3599",10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}();t.TimeUtils=r},94:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenUtils=void 0;var n=r(453),o=r(454),i=r(78),a=function(){function e(){}return e.decodeJwt=function(e){if(o.StringUtils.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>i.TimeUtils.now()+r},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=n.CryptoUtils.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},e}();t.TokenUtils=a},741:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtils=void 0;var n=r(91),o=r(55),i=r(454),a=r(453),s=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=o.ScopeSet.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(o.ScopeSet.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),o=this.GetUrlComponents(r),i=o.PathSegments;return!t||0===i.length||i[0]!==n.Constants.common&&i[0]!==n.SSOTypes.ORGANIZATIONS&&i[0]!==n.SSOTypes.CONSUMERS||(i[0]=t),this.constructAuthorityUriFromObject(o,i)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===n.Constants.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===n.SSOTypes.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===n.SSOTypes.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){if(t){var r=t.toLowerCase();return e.endsWith(r,"/")||(r+="/"),r}return t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(i.StringUtils.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.ServerHashParamKeys.ERROR_DESCRIPTION)||r.hasOwnProperty(n.ServerHashParamKeys.ERROR)||r.hasOwnProperty(n.ServerHashParamKeys.ACCESS_TOKEN)||r.hasOwnProperty(n.ServerHashParamKeys.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return a.CryptoUtils.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}();t.UrlUtils=s},758:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WindowUtils=void 0;var n=r(356),o=r(741),i=r(91),a=r(78),s=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+i.Constants.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,i,s){return new Promise((function(c,u){var l=a.TimeUtils.relativeNowMs()+r;s.verbose("monitorWindowForIframe polling started");var h=setInterval((function(){if(a.TimeUtils.relativeNowMs()>l)return s.error("monitorIframeForHash unable to find hash in url, timing out"),s.errorPii("monitorIframeForHash polling timed out for url: "+i),clearInterval(h),void u(n.ClientAuthError.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&o.UrlUtils.urlContainsHash(e)&&(s.verbose("monitorIframeForHash found url in hash"),clearInterval(h),c(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,r,i,a){return new Promise((function(s,c){var u=r/e.POLLING_INTERVAL_MS,l=0;a.verbose("monitorWindowForHash polling started");var h=setInterval((function(){if(t.closed)return a.error("monitorWindowForHash window closed"),clearInterval(h),void c(n.ClientAuthError.createUserCancelledError());var r;try{r=t.location.href}catch(e){}if(r&&"about:blank"!==r)if(l++,r&&o.UrlUtils.urlContainsHash(r)){a.verbose("monitorPopupForHash found url in hash"),clearInterval(h);var d=t.location.hash;e.clearUrlFragment(t),s(d)}else l>u&&(a.error("monitorPopupForHash unable to find hash in url, timing out"),a.errorPii("monitorPopupForHash polling timed out for url: "+i),clearInterval(h),c(n.ClientAuthError.createTokenRenewalTimeoutError()))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise((function(i,a){setTimeout((function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)}),r)}))},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(r)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(o.UrlUtils.urlContainsHash(window.location.hash)&&e.isInIframe())throw n.ClientAuthError.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(i.TemporaryCacheKeys.REDIRECT_REQUEST);if(t&&!o.UrlUtils.urlContainsHash(window.location.hash)){var r=t.split(i.Constants.resourceDelimiter);r.shift();var n=r.length>0?r.join(i.Constants.resourceDelimiter):null;e.resetTempCacheItems(n)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}();t.WindowUtils=s}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}var n={};return function(){var e=n;Object.defineProperty(e,"__esModule",{value:!0});var t=r(463);Object.defineProperty(e,"UserAgentApplication",{enumerable:!0,get:function(){return t.UserAgentApplication}}),Object.defineProperty(e,"authResponseCallback",{enumerable:!0,get:function(){return t.authResponseCallback}}),Object.defineProperty(e,"errorReceivedCallback",{enumerable:!0,get:function(){return t.errorReceivedCallback}}),Object.defineProperty(e,"tokenReceivedCallback",{enumerable:!0,get:function(){return t.tokenReceivedCallback}});var o=r(89);Object.defineProperty(e,"Logger",{enumerable:!0,get:function(){return o.Logger}});var i=r(89);Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return i.LogLevel}});var a=r(630);Object.defineProperty(e,"Account",{enumerable:!0,get:function(){return a.Account}});var s=r(91);Object.defineProperty(e,"Constants",{enumerable:!0,get:function(){return s.Constants}}),Object.defineProperty(e,"ServerHashParamKeys",{enumerable:!0,get:function(){return s.ServerHashParamKeys}});var c=r(660);Object.defineProperty(e,"Authority",{enumerable:!0,get:function(){return c.Authority}});var u=r(463);Object.defineProperty(e,"CacheResult",{enumerable:!0,get:function(){return u.CacheResult}});var l=r(875);Object.defineProperty(e,"CacheLocation",{enumerable:!0,get:function(){return l.CacheLocation}}),Object.defineProperty(e,"Configuration",{enumerable:!0,get:function(){return l.Configuration}});var h=r(733);Object.defineProperty(e,"AuthenticationParameters",{enumerable:!0,get:function(){return h.AuthenticationParameters}});var d=r(681);Object.defineProperty(e,"AuthResponse",{enumerable:!0,get:function(){return d.AuthResponse}});var p=r(453);Object.defineProperty(e,"CryptoUtils",{enumerable:!0,get:function(){return p.CryptoUtils}});var g=r(741);Object.defineProperty(e,"UrlUtils",{enumerable:!0,get:function(){return g.UrlUtils}});var f=r(758);Object.defineProperty(e,"WindowUtils",{enumerable:!0,get:function(){return f.WindowUtils}});var y=r(986);Object.defineProperty(e,"AuthError",{enumerable:!0,get:function(){return y.AuthError}});var m=r(356);Object.defineProperty(e,"ClientAuthError",{enumerable:!0,get:function(){return m.ClientAuthError}});var v=r(447);Object.defineProperty(e,"ServerError",{enumerable:!0,get:function(){return v.ServerError}});var E=r(550);Object.defineProperty(e,"ClientConfigurationError",{enumerable:!0,get:function(){return E.ClientConfigurationError}});var C=r(961);Object.defineProperty(e,"InteractionRequiredAuthError",{enumerable:!0,get:function(){return C.InteractionRequiredAuthError}});var T=r(700);Object.defineProperty(e,"version",{enumerable:!0,get:function(){return T.version}})}(),n}()}));
//# sourceMappingURL=msal.min.js.map